namespace = ME_Songhai_Events
normal_or_historical_nations = yes

country_event = {
	id = ME_Songhai_Events.1
	title = "ME_Songhai_Events.1.t"
	desc = "ME_Songhai_Events.1.d"
	picture = OVEREXTENSION_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = MAL
		NOT = { is_year = 1493 }
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "ME_Songhai_Events.1.a"
		
		custom_tooltip = ME_Songhai_Events.1.a.tt
		
		add_legitimacy = -20
		hidden_effect = {
			every_country = {
				limit = {
					NOT = { tag = ROOT }
					capital_scope = {
						OR = {
							region = niger_region
							region = sahel_region
							region = guinea_region
						}
					}
				}
				country_event = { id = ME_Songhai_Events.2 }
			}
		}
	}
}

country_event = {
	id = ME_Songhai_Events.2
	title = "ME_Songhai_Events.1.t"
	desc = "ME_Songhai_Events.1.d"
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "ME_Songhai_Events.1.a"
		
		custom_tooltip = ME_Songhai_Events.1.a.tt
		
		if = {
			limit = {
				tag = SON
			}
			
			1132 = {
				limit = {
					NOT = { is_permanent_claim = ROOT }
					NOT = { is_core = ROOT }
				}
				add_permanent_claim = ROOT
			}
		}
	}
}

country_event = {
	id = ME_Songhai_Events.3
	title = "ME_Songhai_Events.3.t"
	desc = "ME_Songhai_Events.3.d"
	picture = OVEREXTENSION_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = SON
		NOT = { dynasty = "Askia" }
		is_year = 1470
		NOT = { is_year = 1493 }
	}
	
	mean_time_to_happen = {
		months = 60
	}
	
	option = {
		name = ME_Songhai_Events.3.a
		
		set_country_flag = son_askia_dynasty_can_rise_flag
		
		define_general = {
			shock = 4
			fire = 2
			manuever = 2
			siege = 1
			name = "Muhammad Askia"
		}
		
		custom_tooltip = ME_Songhai_Events.3.a.tt
	}
	
	option = {
		name = ME_Songhai_Events.3.b
		
		custom_tooltip = ME_Songhai_Events.3.b.tt
	}
}

country_event = {
	id = ME_Songhai_Events.4
	title = "ME_Songhai_Events.4.t"
	desc = "ME_Songhai_Events.4.d"
	picture = OVEREXTENSION_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = SON
		has_country_flag = son_askia_dynasty_can_rise_flag
		NOT = { dynasty = "Askia" }
		NOT = { piety = 0 }
		has_leader = "Muhammad Askia"
	}
	
	mean_time_to_happen = {
		months = 30
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = askia_dynasty_mission_flag
			clr_country_flag = son_askia_dynasty_can_rise_flag
		}
	}
	
	option = {
		name = ME_Songhai_Events.4.a
		
		kill_ruler = yes
		if = {
			limit = {
				has_heir = yes
			}
			kill_heir = yes
		}
		
		define_leader_to_ruler = {
			type = general
			adm = 5
			dip = 3
			mil = 6
			fixed = yes
			claim = 70
			dynasty = "Askia"
			name = "Muhammad Askia"
		}
		
		if = {
			limit = {
				has_states_general_mechanic = yes
			}
			change_statists_vs_orangists = 1
		}
		
		if = {
			limit = {
				has_dlc = "Rights of Man" 
			}
			hidden_effect = { add_ruler_personality = conqueror_personality }
		}
		
		hidden_effect = {
			every_owned_province = {
				add_unrest = 5
			}
		}
		custom_tooltip = ME_Songhai_Events.4.a.tt
		set_country_flag = askia_made_ruler_flag
	}
	
	option = {
		name = ME_Songhai_Events.4.b
		
		capital_scope = {
			spawn_rebels = {
				type = pretender_rebels
				size = 2
				leader = "Muhammad"
				leader_dynasty = "Askia"
			}
		}
	}
}

country_event = {
	id = ME_Songhai_Events.5
	title = "ME_Songhai_Events.5.t"
	desc = "ME_Songhai_Events.5.d"
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "ME_Songhai_Events.5.a"
		
		if = {
			limit = {
				NOT = { government_rank = 3 }
			}
			set_government_rank = 3
		}
		add_government_reform = songhai_empire_reform
	}
}

country_event = {
	id = ME_Songhai_Events.6
	title = "ME_Songhai_Events.6.t"
	desc = "ME_Songhai_Events.6.d"
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "ME_Songhai_Events.6.a"
		
		if = {
			limit = {
				government_rank = 3
			}
			set_government_rank = 2
		}
		else_if = {
			limit = {
				government_rank = 2
			}
			set_government_rank = 1
		}
		else = {
			add_legitimacy = -30
		}
	}
}

country_event = {
	id = ME_Songhai_Events.7
	title = "ME_Songhai_Events.7.t"
	desc = "ME_Songhai_Events.7.d"
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Songhai_Events.7.a
		
		1133 = {
			add_province_modifier = {
				name = son_gao_city_of_songhay
				duration = -1
			}
			if = {
				limit = {
					NOT = { province_has_center_of_trade_of_level = 3 }
				}
				add_center_of_trade_level = 1
			}
			else = {
				add_base_production = 3
			}
		}
	}
	option = {
		name = ME_Songhai_Events.7.b
		
		1132 = {
			add_province_modifier = {
				name = son_timbuktu_city_of_wealth
				duration = -1
			}
			add_base_production = 2
			add_base_tax = 3
		}
	}
	option = {
		name = ME_Songhai_Events.7.c
		
		1131 = {
			add_province_modifier = {
				name = son_macina_centre_of_the_empire
				duration = -1
			}
			add_scaled_local_adm_power = 10
		}
	}
	option = {
		name = ME_Songhai_Events.7.dd
		
		1124 = {
			add_province_modifier = {
				name = son_niani_capital_of_the_mali
				duration = -1
			}
		}
		add_stability_or_adm_power = yes
	}
}

country_event = {
	id = ME_Songhai_Events.8
	title = "ME_Songhai_Events.8.t"
	desc = "ME_Songhai_Events.8.d"
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Songhai_Events.8.a
		
		custom_tooltip = ME_Songhai_Events.8.a.tt
		set_country_flag = son_allow_corp_of_warriors
	}
	
	option = {
		name = ME_Songhai_Events.8.b
		
		add_country_modifier = {
			name = son_the_first_standing_army
			duration = -1
		}
	}
}

country_event = {
	id = ME_Songhai_Events.9
	title = "ME_Songhai_Events.9.t"
	desc = "ME_Songhai_Events.9.d"
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = ME_Songhai_Events.9.a
			
		1131 = {
			add_devastation = 50
			add_base_production = -4
			add_base_tax = -4
		}
		1133 = {
			add_base_production = 4
			add_base_tax = 4
		}
	}
}